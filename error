if ("true".equalsIgnoreCase(forceOcr)) {
    // Force OCR all pages
    ocrOptions = "--force-ocr";
} else if (imagePages.isEmpty()) {
    // Try extracting some text as a test
    String extractedText = tryExtractText(inputPdf);
    if (extractedText == null || extractedText.trim().isEmpty()) {
        // No text detected, force OCR anyway
        ocrOptions = "--force-ocr";
        log.info("No image pages and no extractable text, forcing OCR");
    } else {
        ocrOptions = "--skip-text";
        log.info("No image pages but text found, skipping OCR");
    }
} else {
    // OCR only image pages
    String pagesList = imagePages.stream()
        .sorted()
        .map(String::valueOf)
        .collect(Collectors.joining(","));
    ocrOptions = String.format("--force-ocr --pages %s", pagesList);
}
