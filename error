private static void extractFieldByLabels(String text, List<String> labels, String key, Map<String, List<PdfMetaData>> metadata, int page) {
    for (String label : labels) {
        if (label.equalsIgnoreCase("Patient Name")) {
            // Custom regex to handle common variations and dynamic trailing text without the length restriction
            Pattern pattern = Pattern.compile("(?i)Patient Name\\s*[:\\-]?\\s*([A-Z'\\-\\. ]+)(?=\\s{2,}|\\n|$)");
            Matcher matcher = pattern.matcher(text);
            while (matcher.find()) {
                String value = matcher.group(1).trim().replaceAll("\\s+", " ");
                log.info("Matched patient name: {}", value);
                addToMetadataList(metadata, key, value, page);
            }
            continue; // Skip default logic for this label
        }

        // Default extraction for other labels
        Pattern pattern = Pattern.compile("(?i)" + Pattern.quote(label) + "\\s*[:\\-]?\\s*([\\w\\s]+?)(?=\\s{2,}|\\n|$)");
        Matcher matcher = pattern.matcher(text);
        while (matcher.find()) {
            String value = matcher.group(1).trim();
            log.info("Matched value for {}: {}", key, value);
            addToMetadataList(metadata, key, value, page);
        }
    }
}
